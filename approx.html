<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta name="generator" content="jemdoc, see http://jemdoc.jaboc.net/" />
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link rel="stylesheet" href="jemdoc.css" type="text/css" />
<title>Linear and Nonlinear Approximation</title>
<!-- MathJax -->
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
	  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<!-- End MathJax -->
</head>
<body>
<table summary="Table for page layout." id="tlayout">
<tr valign="top">
<td id="layout-menu">
<div class="menu-category">Clarice Poon</div>
<div class="menu-item"><a href="index.html">Home</a></div>
<div class="menu-category">Research</div>
<div class="menu-item"><a href="publications.html">Publications</a></div>
<div class="menu-category">Teaching</div>
<div class="menu-item"><a href="mathinform.html">Mathematics&nbsp;<br /> of&nbsp;Information</a></div>
<div class="menu-item"><a href="sparsity.html">Sparsity&nbsp;<br /> in&nbsp;Imaging</a></div>
</td>
<td id="layout-content">
<div id="toptitle">
<h1>Linear and Nonlinear Approximation</h1>
</div>
<p><b>Prerequisites</b>: You will need to download Wavelab850.</p>
<h2>Linear approximation</h2>
<p>Recall that the Fourier linear aproximation error is \(O(N^{-2s})\) for \(f \in W^{s, 2}(0,1)\), and \(O(N^{-1})\) for BV functions. The difference for linear wavelet approximations is the treatment of the boundary, for \(f \in W^{s, 2}(0,1)\), the linear approximation error with wavelets of \(q &gt; s\) vanishing moments is \(O(N^{-2s})\) and \(O(N^{-1})\) if \(f \in BV[0, 1]\).</p>
<p>Let's creat a signal \(f(t) = \chi_{(0,1/2)}(t) \frac{t^2}{2} + \chi_{(0,1/2)}(t) \frac{t - t^2}{2}\) in \(W^{2,2}(0, 1)\).</p>
<div class="codeblock">
<div class="blockcontent"><pre>
N=1024;
t=linspace(0,1,N);
fun = @(t) (t<span class="operator">&gt;</span>0).*(t&lt;0.5).*t.^2/2 + (t-t.^2)/2.*(t&lt;1).*(t<span class="operator">&gt;</span>=0.5);
f = fun(t);<span class="comment">%</span>
normf = norm(f)^2;
figure;
plot(f);
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img01.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Compute the linear approximation from the first 30% of the Fourier coefficients and compute the error decay rate:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
<span class="comment">%% fourier</span>
p=ceil(0.15*N);
hat = fft(f);
hatf = zeros(1,N);
hatf(1:p+1) = hat(1:p+1);
hatf(N-p+1:N) =hat(N-p+1:N);
fourf = ifft(hatf);
fourerr = norm(fourf - f)^2;
four_decay_exponent = log(fourerr)/log(p)
<span class="comment">% four\_decay\_exponent = -3.2828</span>
figure;
plot(fourf);
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img02.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Calculate the linear wavelet decay rate using the Daubechies wavelet of 2 vanishing moments:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
a=2;
L=ceil(log2(2*a))+1;
wc = FWT_CDJV(f,L,a);
wc_approx = zeros(1,N);
wc_approx(1:2*p) = wc(1:2*p);
daub_rec = IWT_CDJV(wc_approx,L,a);
wav_err = norm(daub_rec - f)^2;
wavelet_decay_exponent = log(wav_err)/log(p)
<span class="comment">% wavelet_decay_exponent = -3.2714</span>
plot(daub_rec);
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img03.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Let's now repeat this exercise for the nonperiodic function \(f(t) = t(t-\frac{1}{2})(t-\frac{1}{4})\) defined on \([0, 1]\):</p>
<div class="codeblock">
<div class="blockcontent"><pre>
N=1024;
t=linspace(0,1,N);
fun = @(t) t.*(t-0.5).*(t-1/4);
f = fun(t);<span class="comment">%</span>
normf = norm(f)^2;
figure;
plot(f);
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img04.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>What is its Fourier linear approximation?</p>
<div class="codeblock">
<div class="blockcontent"><pre>
<span class="comment">%% fourier</span>
p=ceil(0.15*N);
hat = fft(f);
hatf = zeros(1,N);
hatf(1:p+1) = hat(1:p+1);
hatf(N-p+1:N) =hat(N-p+1:N);
fourf = ifft(hatf);
fourerr = norm(fourf - f)^2;
four_decay_exponent = log(fourerr)/log(p)
<span class="comment">% four_decay_exponent = -0.6209</span>
plot(fourf)
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img05.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Check the linear approximation decay for wavelets of 2 and 3 vanishing moments:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
a=2;
L=ceil(log2(2*a))+1;
wc = FWT_CDJV(f,L,a);
wc_approx = zeros(1,N);
wc_approx(1:2*p) = wc(1:2*p);
daub_rec = IWT_CDJV(wc_approx,L,a);
wav_err = norm(daub_rec - f)^2;
wav_decay_exponent_2moments = log(wav_err)/log(p)
<span class="comment">% wav_decay_exponent_2moments = -3.5500</span>
plot(daub_rec)
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img06.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<div class="codeblock">
<div class="blockcontent"><pre>
a=3;
L=ceil(log2(2*a))+1;
wc = FWT_CDJV(f,L,a);
wc_approx = zeros(1,N);
wc_approx(1:2*p) = wc(1:2*p);
daub_rec = IWT_CDJV(wc_approx,L,a);
wav_err = norm(daub_rec - f)^2;
wav_decay_exponent_3moments = log(wav_err)/log(p)
<span class="comment">% wav_decay_exponent_3moments = -5.6750</span>
plot(daub_rec)
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img07.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<h2>Nonlinear Approximation</h2>
<p>Recall that the linear wavelet approximation error for a piecewise smooth function is only \(O(N^{-1})\), this is the same as in the Fourier case. However, the nonlinear approximation error is \(O(N^{-2s})\). </p>
<p><b>Exercise</b>: create a piecewise smooth signal and verify this phenomenon.</p>
<div class="codeblock">
<div class="blockcontent"><pre>
N = 2048;
t=linspace(0,1,N);
fun = @(t) t.*(t-0.5).*(t-1/4).^2+(t<span class="operator">&gt;</span>0).*(t&lt;0.5);
f = fun(t);<span class="comment">%</span>
plot(f)
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img08.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Linear wavelet approximation from 15% of the coefficients:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
a=3; <span class="comment">%number of vanishing moments</span>
ratio =0.15;
p = ceil(ratio*N/2);
<span class="comment">% linear wavelet approx</span>
wc = FWT_CDJV(f,ceil(log2(2*a))+1,a);
wc_approx = zeros(1,N);
wc_approx(1:2*p) = wc(1:2*p);
daub_rec = IWT_CDJV(wc_approx,L,a);
wav_err = norm(daub_rec - f)^2;
cdjv_decay = log(wav_err)/log(p)
<span class="comment">% cdjv_decay = 0.1592</span>
plot(daub_rec)
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img09.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Nonlinear wavelet approximation from 15% of the coefficients:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
<span class="comment">%% nonlinear approx</span>
wc_int = FWT_CDJV(f,ceil(log2(2*a))+1,a);
[<span class="operator">~</span>,indx_int] = sort(abs(wc_int), <span class="string">'descend'</span>);
ratiowc_int = zeros(1,N);
ratiowc_int(indx_int(1:2*p)) = wc_int(indx_int(1:2*p));
daubf_int = IWT_CDJV(ratiowc_int,ceil(log2(2*a))+1,a);
int_err = norm(daubf_int - f)^2;
log(int_err)/log(p)
<span class="comment">% <span class="operator">ans =</span> -5.5426</span>
plot(daubf_int)
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img10.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<p>Nonlinear Fourier approximation from 15% of the coefficients:</p>
<div class="codeblock">
<div class="blockcontent"><pre>
<span class="comment">%% fourier</span>
hat = fft(f);
hatf = zeros(1,N);
[<span class="operator">~</span>,indxf] = sort(abs(hat), <span class="string">'descend'</span>);
hatf(indxf(1:2*p)) = hat(indxf(1:2*p));
fourf = ifft(hatf);
fourerr = norm(fourf - f)^2;
log(fourerr)/log(p)
<span class="comment">% <span class="operator">ans =</span> -0.0033</span>
plot(real(fourf))
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img11.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<div class="codeblock">
<div class="blockcontent"><pre>
figure(3);clf
subplot(411)
plot(f);
title(<span class="string">'original'</span>)
subplot(312)
plot(real(fourf))
title(<span class="string">'Fourier'</span>)
ylim([-0.1+<span class="statement">min</span>(f) <span class="statement">max</span>(f)+.1]);
subplot(313)
plot(daubf_int)
title(<span class="string">'Daubechies (interval adapted)'</span>)
ylim([-0.1+<span class="statement">min</span>(f) <span class="statement">max</span>(f)+.1]);
</pre></div></div>
<table class="imgtable"><tr><td>
<img src="files/approx/img12.png" alt="" height="350px" />&nbsp;</td>
<td align="left"></td></tr></table>
<div id="footer">
<div id="footer-text">
Page generated 2019-01-26, by <a href="https://github.com/wsshin/jemdoc_mathjax" target="blank">jemdoc+MathJax</a>.
</div>
</div>
</td>
</tr>
</table>
</body>
</html>
